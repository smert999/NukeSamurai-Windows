# ๐ฏ Reference Frame Selector - ะัะบะพะฒะพะดััะฒะพ

## ๐ ะงัะพ ะะพะฒะพะณะพ?

**Reference Frame Selector** โ ะฝะพะฒะฐั ััะฝะบัะธั, ะฟะพะทะฒะพะปัััะฐั ะฒัะฑัะฐัั **ะปัะฑะพะน ะบะฐะดั** ะฒ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ ะดะปั ัะฐะทะผะตัะบะธ ะพะฑัะตะบัะฐ, ะฐ ะฝะต ัะพะปัะบะพ ะฟะตัะฒัะน ะบะฐะดั!

---

## ๐ค ะะฐัะตะผ ะญัะพ ะัะถะฝะพ?

### ะัะพะฑะปะตะผะฐ (ัะฐะฝััะต):
- ะะฑัะตะบั ะดะพะปะถะตะฝ ะฑััั ัััะบะพ ะฒะธะดะตะฝ **ะฝะฐ ะฟะตัะฒะพะผ ะบะฐะดัะต**
- ะัะปะธ ะพะฑัะตะบั ัะบััั, ัะฐััะธัะฝะพ ะพะฑัะตะทะฐะฝ ะธะปะธ ัะฐะทะผัั ะฝะฐ ะฟะตัะฒะพะผ ะบะฐะดัะต โ ััะตะบะธะฝะณ ัะฐะฑะพัะฐะตั ะฟะปะพัะพ
- ะัะธัะพะดะธะปะพัั ะผะตะฝััั Frame Range, ััะพะฑั ะฟะตัะฒัะน ะบะฐะดั ะฑัะป "ัะดะพะฑะฝัะผ"

### ะะตัะตะฝะธะต (ัะตะฟะตัั):
โ ะัะฑะธัะฐะนัะต **ะปัะฑะพะน ะบะฐะดั**, ะณะดะต ะพะฑัะตะบั ะฒะธะดะตะฝ ะปัััะต ะฒัะตะณะพ  
โ ะกะพะทะดะฐะฒะฐะนัะต Bounding Box ะฝะฐ ััะพะผ ะบะฐะดัะต  
โ SAM2 ะฑัะดะตั ะฟัะพะฟะฐะณะธัะพะฒะฐัั ะผะฐัะบั ะฒ **ะพะฑะต ััะพัะพะฝั** ะพั reference frame  

---

## ๐ ะะฐะบ ะัะฟะพะปัะทะพะฒะฐัั

### **ะจะฐะณ 1: ะะฐัััะพะนัะต Frame Range**
ะฃััะฐะฝะพะฒะธัะต ะดะธะฐะฟะฐะทะพะฝ ะบะฐะดัะพะฒ, ะบะพัะพััะน ะฒั ัะพัะธัะต ะพะฑัะฐะฑะพัะฐัั:
```
Frame Range: 1001 - 1200
```

### **ะจะฐะณ 2: ะัะฑะตัะธัะต Reference Frame**
ะะฐะนะดะธัะต ะบะฐะดั, ะณะดะต ะพะฑัะตะบั:
- โ ะฅะพัะพัะพ ะฒะธะดะตะฝ
- โ ะะต ะฟะตัะตะบััั ะดััะณะธะผะธ ะพะฑัะตะบัะฐะผะธ
- โ ะะฐัะพะดะธััั ะฒ ัะพะบััะต
- โ ะะต ัะฐะทะผัั

ะฃััะฐะฝะพะฒะธัะต ะฝะพะผะตั ััะพะณะพ ะบะฐะดัะฐ ะฒ ะฟะพะปะต **Reference Frame**:
```
Reference Frame: 1050  (ะผะพะถะตั ะฑััั ะปัะฑะพะน ะบะฐะดั ะผะตะถะดั 1001 ะธ 1200)
```

### **ะจะฐะณ 3: ะกะพะทะดะฐะนัะต Bounding Box**
1. ะะฐะถะผะธัะต **"Create Bounding Box"**
2. OpenCV ะพัะบัะพะตั **ะบะฐะดั 1050** (ะฒะฐั Reference Frame)
3. ะัะดะตะปะธัะต ะพะฑัะตะบั
4. ะะฐะถะผะธัะต **Enter** ะธะปะธ **Space**

### **ะจะฐะณ 4: ะะตะฝะตัะธััะนัะต ะะฐัะบะธ**
1. ะะฐัััะพะนัะต Output Path
2. ะะฐะถะผะธัะต **"Generate Mask"**
3. SAM2 ะฑัะดะตั:
   - ะะตัะตะบัะธัะพะฒะฐัั ะพะฑัะตะบั ะฝะฐ ะบะฐะดัะต **1050**
   - ะัะพะฟะฐะณะธัะพะฒะฐัั ะผะฐัะบั **ะฝะฐะทะฐะด** ะบ ะบะฐะดัั 1001
   - ะัะพะฟะฐะณะธัะพะฒะฐัั ะผะฐัะบั **ะฒะฟะตััะด** ะบ ะบะฐะดัั 1200

---

## ๐ ะัะธะผะตัั ะัะฟะพะปัะทะพะฒะฐะฝะธั

### **ะัะธะผะตั 1: ะะฑัะตะบั ะฟะพัะฒะปัะตััั ะฒ ัะตัะตะดะธะฝะต ััะตะฝั**

**ะกัะตะฝะฐัะธะน**: ะงะตะปะพะฒะตะบ ะฒัะพะดะธั ะฒ ะบะฐะดั ะฝะฐ 50-ะผ ะบะฐะดัะต ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ.

```
Frame Range:      1001 - 1200
Reference Frame:  1050    โ ะงะตะปะพะฒะตะบ ะฟะพะปะฝะพัััั ะฒะธะดะตะฝ
```

**ะะตะทัะปััะฐั**: ะะฐัะบะฐ ะฟัะพะฟะฐะณะธัะพะฒะฐะฝะฐ ะพั 1050 ะฒ ะพะฑะต ััะพัะพะฝั, ะดะฐะถะต ะตัะปะธ ัะตะปะพะฒะตะบะฐ ะฝะต ะฑัะปะพ ะฝะฐ ะฟะตัะฒัั ะบะฐะดัะฐั.

---

### **ะัะธะผะตั 2: ะะฑัะตะบั ัะฐะทะผัั ะฝะฐ ะฟะตัะฒะพะผ ะบะฐะดัะต**

**ะกัะตะฝะฐัะธะน**: ะะฐะผะตัะฐ ะดะฒะธะถะตััั, ะธ ะพะฑัะตะบั ัััะบะธะน ัะพะปัะบะพ ะฒ ัะตัะตะดะธะฝะต.

```
Frame Range:      1001 - 1182
Reference Frame:  1090    โ ะะฑัะตะบั ะฒ ัะพะบััะต
```

**ะะตะทัะปััะฐั**: ะั ัะฐะทะผะตัะฐะตัะต ัััะบะธะน ะบะฐะดั, SAM2 ัะฐะผ ะพััะปะตะดะธั ะพะฑัะตะบั ะฝะฐ ัะฐะทะผัััั ะบะฐะดัะฐั.

---

### **ะัะธะผะตั 3: ะงะฐััะธัะฝะฐั ะพะบะบะปัะทะธั**

**ะกัะตะฝะฐัะธะน**: ะะฑัะตะบั ัะฐััะธัะฝะพ ัะบััั ะฝะฐ ะฟะตัะฒะพะผ ะบะฐะดัะต, ะฝะพ ะฟะพะปะฝะพัััั ะฒะธะดะตะฝ ะฟะพะทะถะต.

```
Frame Range:      1001 - 1200
Reference Frame:  1120    โ ะะฑัะตะบั ะฟะพะปะฝะพัััั ะฒะธะดะตะฝ
```

**ะะตะทัะปััะฐั**: ะะฐะถะต ะตัะปะธ ะพะฑัะตะบั ัะฐััะธัะฝะพ ัะบััั ะฒ ะฝะฐัะฐะปะต, SAM2 ะฟัะฐะฒะธะปัะฝะพ ะตะณะพ ะพััะปะตะดะธั.

---

## ๐ฌ Workflow

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ะัะบัะพะนัะต ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััั ะฒ Nuke             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  2. ะัะพะนะดะธัะตัั ะฟะพ ะบะฐะดัะฐะผ (scrub timeline)          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  3. ะะฐะนะดะธัะต "ะปัััะธะน" ะบะฐะดั ะดะปั ัะฐะทะผะตัะบะธ ะพะฑัะตะบัะฐ     โ
โ     - ะะฑัะตะบั ะฟะพะปะฝะพัััั ะฒะธะดะตะฝ                        โ
โ     - ะะฑัะตะบั ะฝะต ัะฐะทะผัั                              โ
โ     - ะฅะพัะพัะตะต ะพัะฒะตัะตะฝะธะต                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  4. ะะฐะฟะธัะธัะต ะฝะพะผะตั ััะพะณะพ ะบะฐะดัะฐ                      โ
โ     Example: ะบะฐะดั 1085                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  5. ะ ัะทะปะต SAMURAI:                                 โ
โ     - Frame Range: 1001 - 1200                      โ
โ     - Reference Frame: 1085  โ ะะะจ "ะะฃะงะจะะ" ะะะะ    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  6. Create Bounding Box โ ะฒัะดะตะปะธัั ะพะฑัะตะบั           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  7. Generate Mask โ ะฟะพะปััะธัั ะผะฐัะบะธ ะดะปั ะฒัะตั ะบะฐะดัะพะฒ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ๏ธ ะขะตัะฝะธัะตัะบะธะต ะะตัะฐะปะธ

### **ะงัะพ ะัะพะธััะพะดะธั ะะฝัััะธ?**

1. **UI ะฒ Nuke**: ะั ัะบะฐะทัะฒะฐะตัะต `Reference Frame` (ะฝะฐะฟัะธะผะตั, 1085)
2. **getBbox()**: OpenCV ะพัะบััะฒะฐะตั **ะบะฐะดั 1085** ะดะปั ัะพะทะดะฐะฝะธั Bounding Box
3. **GenerateMask()**: ะััะธัะปัะตั `reference_frame_idx = 1085 - 1001 = 84`
4. **sam2_worker.py**: 
   - ะงะธัะฐะตั ะฒัะต ะบะฐะดัั ะธะท ะดะธะฐะฟะฐะทะพะฝะฐ 1001-1200
   - ะะตัะตะดะฐัั ะฒ SAM2: `frame_idx=84` (ะพัะฝะพัะธัะตะปัะฝัะน ะธะฝะดะตะบั)
   - SAM2 ะดะตัะตะบัะธััะตั ะพะฑัะตะบั ะฝะฐ 84-ะผ ะธะฝะดะตะบัะต (ะบะฐะดั 1085)
   - SAM2 ะฟัะพะฟะฐะณะธััะตั ะผะฐัะบั ะฝะฐ ะฒัะต 200 ะบะฐะดัะพะฒ (0-199 ะธะฝะดะตะบัั)

### **ะะฐะปะธะดะฐัะธั**

ะะปะฐะณะธะฝ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะพะฒะตััะตั:
- โ `Reference Frame` ะดะพะปะถะตะฝ ะฑััั **โฅ FrameRangeMin**
- โ `Reference Frame` ะดะพะปะถะตะฝ ะฑััั **โค FrameRangeMax**

ะัะปะธ ะฒั ัะบะฐะถะตัะต Reference Frame ะฒะฝะต ะดะธะฐะฟะฐะทะพะฝะฐ, ะฒั ัะฒะธะดะธัะต ะพัะธะฑะบั:
```
โ๏ธ ะัะธะฑะบะฐ!

Reference Frame (900) ะดะพะปะถะตะฝ ะฑััั ะฒ ะฟัะตะดะตะปะฐั Frame Range (1001 - 1200)
```

---

## ๐ ะกัะฐะฒะฝะตะฝะธะต: ะะฐะฝััะต vs. ะขะตะฟะตัั

| **ะัะฟะตะบั**                  | **ะะฐะฝััะต**                       | **ะขะตะฟะตัั**                          |
|-----------------------------|----------------------------------|-------------------------------------|
| **ะะฐะดั ะดะปั ัะฐะทะผะตัะบะธ**        | ะขะพะปัะบะพ ะฟะตัะฒัะน ะบะฐะดั (`FrameRangeMin`) | ะัะฑะพะน ะบะฐะดั ะฒ ะดะธะฐะฟะฐะทะพะฝะต             |
| **ะะธะฑะบะพััั**                 | โ ะะธะทะบะฐั                        | โ ะััะพะบะฐั                          |
| **ะะฑัะตะบั ัะบััั ะฝะฐ ะฟะตัะฒะพะผ ะบะฐะดัะต** | โ ะะปะพัะพะน ัะตะทัะปััะฐั          | โ ะะฐะฑะพัะฐะตั ะพัะปะธัะฝะพ                 |
| **ะะฑัะตะบั ัะฐะทะผัั ะฝะฐ ะฟะตัะฒะพะผ ะบะฐะดัะต** | โ ะะปะพัะพะน ััะตะบะธะฝะณ           | โ ะะฐะฑะพัะฐะตั ะพัะปะธัะฝะพ                 |
| **ะะตะพะฑัะพะดะธะผะพััั ะผะตะฝััั Frame Range** | โ๏ธ ะงะฐััะพ ะฟัะธัะพะดะธะปะพัั      | โ ะะต ะฝัะถะฝะพ                         |

---

## ๐ก ะกะพะฒะตัั ะธ ะัััะธะต ะัะฐะบัะธะบะธ

### โ **DO (ะะตะปะฐะนัะต)**

1. **ะัะฑะธัะฐะนัะต ะบะฐะดั ั ะปัััะตะน ะฒะธะดะธะผะพัััั**:
   - ะะฑัะตะบั ะฟะพะปะฝะพัััั ะฒ ะบะฐะดัะต
   - ะฅะพัะพัะตะต ะพัะฒะตัะตะฝะธะต
   - ะะธะฝะธะผัะผ motion blur

2. **ะัะฟะพะปัะทัะนัะต ัะตัะตะดะธะฝั ััะตะฝั**:
   - ะัะปะธ ะพะฑัะตะบั ะฒะธะดะตะฝ ะฝะฐ ะฒัะตั ะบะฐะดัะฐั, ะฒัะฑะธัะฐะนัะต ัะตัะตะดะธะฝั ะดะธะฐะฟะฐะทะพะฝะฐ
   - ะญัะพ ัะฝะธะถะฐะตั ะบัะผัะปััะธะฒะฝัั ะพัะธะฑะบั ััะตะบะธะฝะณะฐ

3. **ะญะบัะฟะตัะธะผะตะฝัะธััะนัะต**:
   - ะะพะฟัะพะฑัะนัะต ัะฐะทะฝัะต Reference Frames ะดะปั ัะปะพะถะฝัั ััะตะฝ
   - SAM2 ะผะพะถะตั ะดะฐะฒะฐัั ัะฐะทะฝัะต ัะตะทัะปััะฐัั ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั reference frame

### โ **DON'T (ะะต ะดะตะปะฐะนัะต)**

1. **ะะต ะฒัะฑะธัะฐะนัะต ัะฐะทะผัััะต ะบะฐะดัั**:
   - ะะฐะถะต ะตัะปะธ ะพะฑัะตะบั ะฒะธะดะตะฝ, ัะฐะทะผััะธะต ัััะดัะฐะตั ะดะตัะตะบัะธั

2. **ะะต ะธัะฟะพะปัะทัะนัะต ะบะฐะดัั ั ะพะบะบะปัะทะธะตะน**:
   - ะัะปะธ ะพะฑัะตะบั ัะฐััะธัะฝะพ ัะบััั โ ะธัะธัะต ะบะฐะดั, ะณะดะต ะพะฝ ะฒะธะดะตะฝ ะฟะพะปะฝะพัััั

3. **ะะต ะทะฐะฑัะฒะฐะนัะต ะฟัะพะฒะตัััั ะณัะฐะฝะธัั**:
   - Reference Frame ะดะพะปะถะตะฝ ะฑััั **ัััะพะณะพ ะฒะฝัััะธ** Frame Range

---

## ๐ ะัะพะณัะตัั-ะะฐั

ะขะตะฟะตัั ะฒั ัะฒะธะดะธัะต ะฒ ะฟัะพะณัะตัั-ะฑะฐัะต ะฝะพะผะตั reference frame:

```
Loading Model...
Initializing Video...
Reading Frames...
Detecting Object on Frame 1085...  โ ะะะะะ!
Frame 1001/1200 (0%)
Frame 1050/1200 (25%)
...
Saving Complete!
```

ะ ะบะพะฝัะพะปะธ:
```
[SAM2 Worker] Using reference frame: 1085 (index 84 in sequence)
```

---

## ๐ฏ ะะฐะบะปััะตะฝะธะต

**Reference Frame Selector** ะดะตะปะฐะตั NukeSamurai **ะฝะฐะผะฝะพะณะพ ะฑะพะปะตะต ะณะธะฑะบะธะผ**:

- โ ะะฐะฑะพัะฐะตั ั ะพะฑัะตะบัะฐะผะธ, ะบะพัะพััะต ะฟะพัะฒะปััััั/ะธััะตะทะฐัั
- โ ะัััะต ัะฟัะฐะฒะปัะตััั ั motion blur
- โ ะะตะฝััะต ััะตะฑะพะฒะฐะฝะธะน ะบ ะฟะตัะฒะพะผั ะบะฐะดัั
- โ ะะพะปะตะต ัะพัะฝัะน ััะตะบะธะฝะณ ะดะปั ัะปะพะถะฝัั ััะตะฝ

**ะะพะฟัะพะฑัะนัะต ะฟััะผะพ ัะตะนัะฐั!** ะะตัะตะทะฐะฟัััะธัะต Nuke ะธ ะธัะฟะพะปัะทัะนัะต ะฝะพะฒะพะต ะฟะพะปะต **Reference Frame** ะฒ ัะทะปะต SAMURAI.

---

## ๐ ะกะฒัะทะฐะฝะฝัะต ะะพะบัะผะตะฝัั

- `IMPROVEMENTS.md` โ ะัะต ัะปัััะตะฝะธั v1.1
- `README.md` โ ะัะฝะพะฒะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั
- `INSTALL.md` โ ะะฝััััะบัะธะธ ะฟะพ ัััะฐะฝะพะฒะบะต

---

ะกัะฐััะปะธะฒะพะณะพ ััะตะบะธะฝะณะฐ! ๐ฌโจ

